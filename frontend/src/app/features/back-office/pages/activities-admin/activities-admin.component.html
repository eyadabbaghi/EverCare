<div class="min-h-screen bg-gradient-to-br from-[#FAF8FC] to-[#F3E8FF] px-6 py-8">
  <div class="max-w-6xl mx-auto space-y-6">
    <!-- Header -->
    <header class="flex items-center justify-between gap-4">
      <div>
        <h1 class="text-3xl font-bold text-[#2D1B4E] mb-1">
          Activities management
        </h1>
        <p class="text-sm text-[#6B5B8C]">
          Create, edit, and curate the activities exactly as patients see them in the front office.
        </p>
      </div>

      <button
        type="button"
        class="inline-flex items-center px-4 py-2 rounded-full bg-[#7C3AED] text-white text-sm font-medium shadow-sm hover:bg-[#6D28D9] transition-colors"
        (click)="startCreate()"
      >
        <span class="mr-2 text-lg">Ôºã</span>
        New activity
      </button>
    </header>

    <!-- Content -->
    <section class="grid grid-cols-1 xl:grid-cols-2 gap-6 items-start">
      <!-- Left side: list styled like front office cards -->
      <div class="space-y-4">
        <h2 class="text-sm font-semibold text-[#6B5B8C] uppercase tracking-wide">
          Library
        </h2>

        <div class="space-y-4">
          <div
  *ngFor="let activity of pagedActivities"
  class="cursor-pointer group"
  (click)="selectActivity(activity); $event.stopPropagation()"
  (dblclick)="goToDetails(activity); $event.stopPropagation()"
>
            <div
              class="border-2 rounded-2xl overflow-hidden transition-all duration-300"
              [ngClass]="
                selectedActivity?.id === activity.id
                  ? 'border-[#7C3AED] bg-white shadow-xl'
                  : 'border-[#DDD6FE] bg-white group-hover:shadow-xl'
              "
            >
              <!-- Image + badges (mirrors front office cards) -->
              <div class="relative h-44 overflow-hidden">
                <img
                  [src]="activity.imageUrl || '/assets/logo.png'"
                  [alt]="activity.name"
                  class="w-full h-full object-cover"
                />

                <div class="absolute top-3 right-3 flex gap-2">
                  <span
                    *ngIf="activity.doctorSuggested"
                    class="inline-flex items-center rounded-full bg-[#C4B5FD] text-[#2D1B4E] px-2 py-1 text-xs font-medium border border-[#7C3AED]"
                  >
                    ‚ú® Doctor
                  </span>
                  <span
                    class="inline-flex items-center rounded-full bg-white/90 text-[#2D1B4E] px-2 py-1 text-xs font-medium"
                  >
                    ‚òÖ {{ activity.rating | number : '1.1-1' }}
                  </span>
                </div>
              </div>

              <!-- Content -->
              <div class="p-4 space-y-3">
                <div class="flex items-start justify-between gap-4">
                  <div class="flex-1">
                    <h3 class="text-lg font-semibold text-[#2D1B4E] mb-1">
                      {{ activity.name || 'Untitled activity' }}
                    </h3>
                    <p class="text-xs text-[#6B5B8C] line-clamp-2">
                      {{ activity.description || 'No description yet.' }}
                    </p>
                  </div>

                  <div class="space-y-1 text-right">
                    <div
                      class="inline-flex items-center rounded-full border px-3 py-1 text-[11px]"
                      [ngClass]="{
                        'bg-blue-100 text-blue-700 border-blue-200': activity.type === 'Relaxation',
                        'bg-purple-100 text-purple-700 border-purple-200': activity.type === 'Cognitive',
                        'bg-green-100 text-green-700 border-green-200': activity.type === 'Physical',
                        'bg-pink-100 text-pink-700 border-pink-200': activity.type === 'Social',
                        'bg-orange-100 text-orange-700 border-orange-200': activity.type === 'Creative'
                      }"
                    >
                      {{ activity.type }}
                    </div>
                    <div
                      class="inline-flex items-center rounded-full border px-3 py-1 text-[11px]"
                      [ngClass]="{
                        'bg-green-100 text-green-700 border-green-200': activity.difficulty === 'Easy',
                        'bg-yellow-100 text-yellow-700 border-yellow-200': activity.difficulty === 'Moderate',
                        'bg-orange-100 text-orange-700 border-orange-200': activity.difficulty === 'Challenging'
                      }"
                    >
                      {{ activity.difficulty }}
                    </div>
                  </div>
                </div>

                <div class="flex items-center justify-between text-xs text-[#6B5B8C]">
                  <div class="flex items-center gap-4">
                    <div class="flex items-center gap-1">
                      <span>‚è±</span>
                      <span>{{ activity.duration }} min</span>
                    </div>
                    <div class="flex items-center gap-1" *ngIf="activity.scheduledTime">
                      <span>üïí</span>
                      <span>{{ activity.scheduledTime }}</span>
                    </div>
                  </div>

                  <div class="flex items-center gap-2">
                    <button
                      type="button"
                      class="px-2 py-1 rounded-full text-[11px] border border-[#E5D9FF] text-[#7C3AED] bg-[#F3E8FF] hover:bg-[#EDE9FE]"
                      (click)="selectActivity(activity); $event.stopPropagation()"
                    >
                      Edit
                    </button>
                    <button
                      type="button"
                      class="px-2 py-1 rounded-full text-[11px] border border-rose-200 text-rose-700 bg-rose-50 hover:bg-rose-100"
                      (click)="deleteActivity(activity); $event.stopPropagation()"
                    >
                      Delete
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <p
            *ngIf="activitiesWithDetails.length === 0"
            class="text-sm text-[#6B5B8C] text-center border border-dashed border-[#DDD6FE] rounded-xl py-6 bg-white/70"
          >
            No activities yet. Click <span class="font-semibold">New activity</span> to add your first
            one.
          </p>

          <!-- Pagination -->
          <div
            *ngIf="activitiesWithDetails.length > pageSize"
            class="flex items-center justify-between pt-2 text-xs text-[#6B5B8C]"
          >
            <div>
              Page
              <span class="font-semibold text-[#2D1B4E]">{{ currentPage }}</span>
              of
              <span class="font-semibold text-[#2D1B4E]">{{ totalPages }}</span>
            </div>

            <div class="inline-flex items-center gap-1 bg-white/80 rounded-full px-1 py-0.5 border border-[#E5D9FF]">
              <button
                type="button"
                class="px-2 py-1 rounded-full hover:bg-[#F3E8FF] disabled:opacity-50"
                (click)="prevPage()"
                [disabled]="currentPage === 1"
              >
                ‚Äπ
              </button>
              <button
                *ngFor="let page of pages"
                type="button"
                class="min-w-[2rem] px-2 py-1 rounded-full text-xs"
                [ngClass]="
                  page === currentPage
                    ? 'bg-[#7C3AED] text-white shadow-sm'
                    : 'text-[#6B5B8C] hover:bg-[#F3E8FF]'
                "
                (click)="setPage(page)"
              >
                {{ page }}
              </button>
              <button
                type="button"
                class="px-2 py-1 rounded-full hover:bg-[#F3E8FF] disabled:opacity-50"
                (click)="nextPage()"
                [disabled]="currentPage === totalPages"
              >
                ‚Ä∫
              </button>
            </div>
          </div>
        </div>
      </div>

     <!-- Right side: CRUD form + live preview, matching front-office details -->
<div class="space-y-4">
  <h2 class="text-sm font-semibold text-[#6B5B8C] uppercase tracking-wide">
    {{ formMode === 'create' ? 'Create activity' : 'Edit activity' }}
  </h2>

  <div class="space-y-4" [formGroup]="activityForm">
    <!-- Basic info card -->
    <div class="rounded-2xl bg-white border border-[#E5D9FF] p-5 space-y-4">
      <div class="flex items-center justify-between gap-4">
        <div>
          <h3 class="text-sm font-semibold text-[#2D1B4E]">Basic information</h3>
          <p class="text-xs text-[#6B5B8C]">These fields control the main card shown in the front office.</p>
        </div>
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm">
        <!-- Title -->
        <div class="space-y-1">
          <label class="text-xs font-medium text-[#4B5563]">Title *</label>
          <input
            type="text"
            formControlName="name"
            class="w-full rounded-xl border border-[#E5E7EB] px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#C4B5FD]"
            [class.border-red-500]="activityForm.get('name')?.invalid && activityForm.get('name')?.touched"
            placeholder="Morning Breathing Exercise"
          />
          <div *ngIf="activityForm.get('name')?.invalid && activityForm.get('name')?.touched" class="text-red-500 text-xs">
            <span *ngIf="activityForm.get('name')?.errors?.['required']">Name is required.</span>
            <span *ngIf="activityForm.get('name')?.errors?.['minlength']">Minimum 3 characters.</span>
            <span *ngIf="activityForm.get('name')?.errors?.['maxlength']">Maximum 100 characters.</span>
            <span *ngIf="activityForm.get('name')?.errors?.['firstLetterUppercase']">First letter must be uppercase.</span>
          </div>
        </div>

        <!-- Type -->
        <div class="space-y-1">
          <label class="text-xs font-medium text-[#4B5563]">Type *</label>
          <select
            formControlName="type"
            class="w-full rounded-xl border border-[#E5E7EB] px-3 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-[#C4B5FD]"
            [class.border-red-500]="activityForm.get('type')?.invalid && activityForm.get('type')?.touched"
          >
            <option *ngFor="let t of activityTypes" [value]="t">{{ t }}</option>
          </select>
          <div *ngIf="activityForm.get('type')?.invalid && activityForm.get('type')?.touched" class="text-red-500 text-xs">
            Type is required.
          </div>
        </div>

        <!-- Duration with +/- buttons -->
<div class="space-y-1">
  <label class="text-xs font-medium text-[#4B5563]">Duration (minutes) *</label>
  <div class="flex items-center gap-2">
    <button
      type="button"
      class="w-8 h-8 rounded-full bg-[#F3E8FF] text-[#7C3AED] hover:bg-[#EDE9FE] transition-colors flex items-center justify-center"
      (click)="decrementDuration()"
      [disabled]="activityForm.get('duration')?.value <= 1"
    >
      <span class="text-lg">‚àí</span>
    </button>
    <input
      type="number"
      min="1"
      formControlName="duration"
      class="w-20 text-center rounded-xl border border-[#E5E7EB] px-2 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#C4B5FD]"
      [class.border-red-500]="activityForm.get('duration')?.invalid && activityForm.get('duration')?.touched"
    />
    <button
      type="button"
      class="w-8 h-8 rounded-full bg-[#F3E8FF] text-[#7C3AED] hover:bg-[#EDE9FE] transition-colors flex items-center justify-center"
      (click)="incrementDuration()"
      [disabled]="activityForm.get('duration')?.value >= 480"
    >
      <span class="text-lg">+</span>
    </button>
  </div>
  <div *ngIf="activityForm.get('duration')?.invalid && activityForm.get('duration')?.touched" class="text-red-500 text-xs">
    <span *ngIf="activityForm.get('duration')?.errors?.['required']">Duration is required.</span>
    <span *ngIf="activityForm.get('duration')?.errors?.['min']">Minimum 1 minute.</span>
    <span *ngIf="activityForm.get('duration')?.errors?.['max']">Maximum 480 minutes.</span>
  </div>
</div>

<!-- Scheduled time as dropdown -->
<div class="space-y-1">
  <label class="text-xs font-medium text-[#4B5563]">Scheduled time (optional)</label>
  <select
    formControlName="scheduledTime"
    class="w-full rounded-xl border border-[#E5E7EB] px-3 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-[#C4B5FD]"
  >
    <option value="">Select time</option>
    <option *ngFor="let time of timeOptions" [value]="time">{{ time }}</option>
  </select>
</div>

        <!-- Image URL -->
        <div class="space-y-1 sm:col-span-2">
          <label class="text-xs font-medium text-[#4B5563]">Image URL *</label>
          <input
            type="text"
            formControlName="imageUrl"
            class="w-full rounded-xl border border-[#E5E7EB] px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#C4B5FD]"
            [class.border-red-500]="activityForm.get('imageUrl')?.invalid && activityForm.get('imageUrl')?.touched"
            placeholder="https://images.unsplash.com/..."
          />
          <div *ngIf="activityForm.get('imageUrl')?.invalid && activityForm.get('imageUrl')?.touched" class="text-red-500 text-xs">
            <span *ngIf="activityForm.get('imageUrl')?.errors?.['required']">Image URL is required.</span>
            <span *ngIf="activityForm.get('imageUrl')?.errors?.['pattern']">Must be a valid URL starting with http:// or https://</span>
          </div>
        </div>

        <!-- Description -->
        <div class="space-y-1 sm:col-span-2">
          <label class="text-xs font-medium text-[#4B5563]">Short description *</label>
          <textarea
            rows="3"
            formControlName="description"
            class="w-full rounded-xl border border-[#E5E7EB] px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#C4B5FD]"
            [class.border-red-500]="activityForm.get('description')?.invalid && activityForm.get('description')?.touched"
            placeholder="This is what patients will see on the card and details page."
          ></textarea>
          <div *ngIf="activityForm.get('description')?.invalid && activityForm.get('description')?.touched" class="text-red-500 text-xs">
            <span *ngIf="activityForm.get('description')?.errors?.['required']">Description is required.</span>
            <span *ngIf="activityForm.get('description')?.errors?.['minlength']">Minimum 10 characters.</span>
            <span *ngIf="activityForm.get('description')?.errors?.['maxlength']">Maximum 1000 characters.</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Configuration card (detailsForm) -->
    <div class="rounded-2xl bg-white border border-[#E5D9FF] p-5 space-y-4" [formGroup]="detailsForm">
      <h3 class="text-sm font-semibold text-[#2D1B4E]">Configuration</h3>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm">
        <!-- Difficulty -->
        <div class="space-y-1">
          <label class="text-xs font-medium text-[#4B5563]">Difficulty *</label>
          <select
            formControlName="difficulty"
            class="w-full rounded-xl border border-[#E5E7EB] px-3 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-[#C4B5FD]"
            [class.border-red-500]="detailsForm.get('difficulty')?.invalid && detailsForm.get('difficulty')?.touched"
          >
            <option *ngFor="let d of difficultyLevels" [value]="d">{{ d }}</option>
          </select>
          <div *ngIf="detailsForm.get('difficulty')?.invalid && detailsForm.get('difficulty')?.touched" class="text-red-500 text-xs">
            Difficulty is required.
          </div>
        </div>

        <!-- Frequency -->
        <div class="space-y-1">
          <label class="text-xs font-medium text-[#4B5563]">Frequency *</label>
          <input
            type="text"
            formControlName="frequency"
            class="w-full rounded-xl border border-[#E5E7EB] px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#C4B5FD]"
            [class.border-red-500]="detailsForm.get('frequency')?.invalid && detailsForm.get('frequency')?.touched"
            placeholder="Daily, 3 times per week..."
          />
          <div *ngIf="detailsForm.get('frequency')?.invalid && detailsForm.get('frequency')?.touched" class="text-red-500 text-xs">
            Frequency is required.
          </div>
        </div>

        <!-- Supervision -->
        <div class="space-y-1 sm:col-span-2">
          <label class="text-xs font-medium text-[#4B5563]">Supervision *</label>
          <input
            type="text"
            formControlName="supervision"
            class="w-full rounded-xl border border-[#E5E7EB] px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#C4B5FD]"
            [class.border-red-500]="detailsForm.get('supervision')?.invalid && detailsForm.get('supervision')?.touched"
            placeholder="Independent, caregiver presence recommended..."
          />
          <div *ngIf="detailsForm.get('supervision')?.invalid && detailsForm.get('supervision')?.touched" class="text-red-500 text-xs">
            Supervision is required.
          </div>
        </div>

        <!-- Recommended stages -->
        <div class="space-y-2 sm:col-span-2">
          <label class="text-xs font-medium text-[#4B5563]">Recommended Alzheimer stages *</label>
          <div class="flex flex-wrap gap-2">
            <button
              type="button"
              *ngFor="let stage of stages"
              class="px-3 py-1 rounded-full text-xs border"
              [ngClass]="
                (detailsForm.get('recommendedStage')?.value || []).includes(stage)
                  ? 'bg-[#7C3AED] border-[#7C3AED] text-white'
                  : 'bg-white border-[#E5E7EB] text-[#4B5563]'
              "
              (click)="toggleStage(stage)"
            >
              {{ stage }}
            </button>
          </div>
          <div *ngIf="detailsForm.get('recommendedStage')?.invalid && detailsForm.get('recommendedStage')?.touched" class="text-red-500 text-xs">
            At least one stage must be selected.
          </div>
        </div>

        <!-- Doctor suggested checkbox -->
        <label class="inline-flex items-center gap-2 text-xs text-[#4B5563] sm:col-span-2">
          <input
            type="checkbox"
            formControlName="doctorSuggested"
            class="rounded border-[#E5E7EB] text-[#7C3AED] focus:ring-[#7C3AED]"
          />
          <span>Doctor suggested</span>
        </label>
      </div>
    </div>

 
    <!-- Actions -->
    <div class="flex items-center justify-between gap-4">
      <div class="text-xs text-[#6B5B8C]">
        Saving will immediately update how this activity looks in the front-office cards and details page.
      </div>
      <div class="flex items-center gap-2">
        <button
          type="button"
          class="inline-flex items-center px-4 py-2 rounded-full bg-[#7C3AED] text-white text-sm font-medium shadow-sm hover:bg-[#6D28D9] transition-colors"
          (click)="saveActivity()"
        >
          <span class="mr-2">üíæ</span>
          Save activity
        </button>
        <button
          type="button"
          class="inline-flex items-center px-3 py-2 rounded-full bg-rose-50 text-rose-700 text-xs font-medium border border-rose-200 hover:bg-rose-100 transition-colors"
          (click)="deleteCurrentActivity()"
          [disabled]="!selectedActivity"
        >
          <span class="mr-1">üóëÔ∏è</span>
          Delete
        </button>
      </div>
    </div>
  </div>
</div>
         