<nav class="bg-white border-b border-[#C4B5FD] sticky top-0 z-40 shadow-sm">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <!-- Logo -->
<button
  type="button"
  class="flex items-center space-x-3 cursor-pointer"
  (click)="navigate('/')"
>
 <div class="bg-[#7C3AED] rounded-full p-2">
 
 <svg width="32" height="32" viewBox="0 0 24 24" fill="white" stroke="none">
            <path d="M20.42 4.58a5.4 5.4 0 0 0-7.65 0l-.77.78-.77-.78a5.4 5.4 0 0 0-7.65 0C1.46 6.54 1.33 10.8 4 14l8 8 8-8c2.67-3.2 2.54-7.46-.58-9.42z"/>
          </svg>
</div>


  <span class="text-xl font-bold text-[#2D1B4E]">
    EverCare
  </span>
</button>


      <!-- Desktop nav -->
      <div class="hidden md:flex items-center space-x-1">
        <button
          *ngFor="let item of navItems"
          type="button"
          (click)="navigate(item.route)"
          class="flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors"
          [ngClass]="
            isActive(item.route)
              ? 'bg-[#F3E8FF] text-[#7C3AED]'
              : 'text-[#6B5B8C] hover:bg-[#F3E8FF] hover:text-[#7C3AED]'
          "
        >
          <span>{{ item.label }}</span>
        </button>
      </div>

      <!-- Right section -->
      <div class="flex items-center space-x-3">
        <!-- Notifications -->
        <div class="relative">
          <button
            type="button"
            class="relative inline-flex items-center justify-center w-9 h-9 rounded-full hover:bg-[#F3E8FF]"
            (click)="openAlerts()"
          >
            <span class="text-[#6B5B8C]">üîî</span>
            <span
              *ngIf="unreadCount > 0"
              class="absolute -top-1 -right-1 w-5 h-5 bg-[#C06C84] rounded-full text-white text-xs flex items-center justify-center font-semibold"
            >
              {{ unreadCount }}
            </span>
          </button>

          <!-- Notifications dropdown -->
          <div
            *ngIf="notificationsOpen"
            class="absolute right-0 mt-2 w-80 max-w-[calc(100vw-2rem)] bg-white border border-[#E5E7EB] rounded-xl shadow-lg overflow-hidden"
          >
            <div class="px-4 py-2 flex items-center justify-between">
              <span class="text-sm font-semibold text-[#2D1B4E]">Notifications</span>
              <button
                type="button"
                class="text-xs text-[#7C3AED] hover:underline"
                *ngIf="unreadCount > 0"
                (click)="markAllAsRead()"
              >
                Mark all as read
              </button>
            </div>
            <div class="border-t border-[#E5E7EB] max-h-80 overflow-y-auto">
              <ng-container *ngIf="notifications.length; else noNotifications">
                <button
                  type="button"
                  *ngFor="let n of notifications"
                  class="w-full text-left px-4 py-3 border-b border-[#E5E7EB] last:border-0 hover:bg-[#F9FAFB] flex gap-3"
                  [ngClass]="{ 'bg-[#F3E8FF]': !n.read }"
                  (click)="handleNotificationClick(n)"
                >
                  <div class="mt-1">
                    <span *ngIf="n.type === 'alert'">‚ö†Ô∏è</span>
                    <span *ngIf="n.type === 'appointment'">üìÖ</span>
                    <span *ngIf="n.type === 'medication'">üíä</span>
                    <span *ngIf="n.type === 'message'">üí¨</span>
                  </div>
                  <div class="flex-1 min-w-0">
                    <div class="flex items-start justify-between gap-2 mb-1">
                      <p class="text-xs font-semibold text-[#2D1B4E]">
                        {{ n.title }}
                      </p>
                      <span
                        *ngIf="n.severity"
                        class="text-[10px] px-2 py-0.5 rounded-full"
                        [ngClass]="getSeverityClasses(n.severity)"
                      >
                        {{ n.severity }}
                      </span>
                    </div>
                    <p class="text-xs text-[#6B5B8C] line-clamp-2">
                      {{ n.message }}
                    </p>
                    <p class="text-[10px] text-[#9CA3AF] mt-1">
                      {{ n.time }}
                    </p>
                  </div>
                </button>
              </ng-container>
              <ng-template #noNotifications>
                <div class="py-6 text-center text-[#6B5B8C] text-sm">
                  No notifications
                </div>
              </ng-template>
            </div>
            <button
              type="button"
              class="w-full text-center text-xs text-[#7C3AED] py-2 hover:bg-[#F3E8FF]"
              (click)="navigate('/alerts')"
            >
              View all alerts
            </button>
          </div>
        </div>

        <!-- User dropdown -->
        <div class="hidden md:block relative">
          <button
            type="button"
            class="flex items-center space-x-2 px-2 py-1 rounded-full hover:bg-[#F3E8FF]"
            (click)="toggleProfileMenu()"
          >
            <div
              class="w-9 h-9 rounded-full bg-[#C4B5FD] text-[#7C3AED] flex items-center justify-center text-sm font-semibold"
            >
              {{ getInitials(user.name) }}
            </div>
            <div class="flex flex-col text-left">
              <span class="text-xs font-medium text-[#2D1B4E]">
                {{ user.name }}
              </span>
              <span class="text-[11px] text-[#6B5B8C]">
                {{ user.role | titlecase }}
              </span>
            </div>
          </button>

          <!-- Profile dropdown -->
          <div
            *ngIf="profileOpen"
            class="absolute right-0 mt-2 w-64 bg-white border border-[#E5E7EB] rounded-xl shadow-lg overflow-hidden z-50"
          >
            <div class="px-4 py-3 border-b border-[#E5E7EB] flex items-center space-x-3">
              <div
                class="w-10 h-10 rounded-full bg-[#C4B5FD] text-[#7C3AED] flex items-center justify-center text-sm font-semibold"
              >
                {{ getInitials(user.name) }}
              </div>
              <div class="flex-1 min-w-0">
                <p class="text-sm font-semibold text-[#2D1B4E] truncate">
                  {{ user.name }}
                </p>
                <p class="text-xs text-[#6B5B8C] truncate">
                  {{ user.email }}
                </p>
                <p class="inline-flex items-center mt-1 px-2 py-0.5 rounded-full text-[10px] bg-[#7C3AED] text-white capitalize">
                  {{ user.role }}
                </p>
              </div>
            </div>
            <button
              type="button"
              class="w-full text-left px-4 py-2.5 text-sm text-[#2D1B4E] hover:bg-[#F3E8FF] flex items-center"
              (click)="goToProfile()"
            >
              <span class="mr-2">üë§</span>
              My Profile
            </button>
            <button
              type="button"
              class="w-full text-left px-4 py-2.5 text-sm text-[#C06C84] hover:bg-red-50 flex items-center border-t border-[#F3E8FF]"
              (click)="logout()"
            >
              <span class="mr-2">‚Ü©</span>
              Log out
            </button>
          </div>
        </div>

        <!-- Mobile menu toggle -->
        <button
          type="button"
          class="md:hidden inline-flex items-center justify-center w-9 h-9 rounded-full hover:bg-[#F3E8FF]"
          (click)="toggleMobileMenu()"
        >
          <span *ngIf="!isMobileMenuOpen">‚ò∞</span>
          <span *ngIf="isMobileMenuOpen">‚úï</span>
        </button>
      </div>
    </div>

    <!-- Mobile nav -->
    <div
      *ngIf="isMobileMenuOpen"
      class="md:hidden border-t border-[#C4B5FD] bg-white px-4 pb-4 space-y-2"
    >
      <button
        *ngFor="let item of navItems"
        type="button"
        class="w-full flex items-center justify-start px-3 py-2 rounded-md text-sm font-medium"
        [ngClass]="
          isActive(item.route)
            ? 'bg-[#F3E8FF] text-[#7C3AED]'
            : 'text-[#6B5B8C] hover:bg-[#F3E8FF] hover:text-[#7C3AED]'
        "
        (click)="navigate(item.route)"
      >
        {{ item.label }}
      </button>
    </div>
  </div>
</nav>

